(self.webpackChunk_720yun_tour_player=self.webpackChunk_720yun_tour_player||[]).push([[168],{9168:function(t,e,n){"use strict";n.r(e),n.d(e,{default:function(){return ut}});n(30489),n(12419),n(41539),n(88674),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948),n(35666),n(92222),n(21249),n(68309);var r=n(67294),o=n(66317),a=(n(54747),n(88860)),i=n(63412),s=n(94315),l=n.n(s),u=function(t){var e,n;null!==(e=t.env)&&void 0!==e&&e.refImageUrl&&(t.env.refImageUrl=(0,i.ZP)(t.env.refImageUrl,a.PUBLIC_DOMAIN));var r=null!==(n=t.materials)&&void 0!==n?n:[],o=["map","alphaMap","aoMap","bumpMap","displacementMap","emissiveMap","envMap","lightMap","metalnessMap","normalMap","roughnessMap"];r.forEach((function(e){o.forEach((function(n){var r,o,s=e[n];if(null!=s&&null!==(r=s.media)&&void 0!==r&&r.url)if(1===(null==t||null===(o=t.meida)||void 0===o?void 0:o.deleted))s.media.url=null;else if(window.baseUrl&&l().ios()&&s.media.ios_url)s.media.url="".concat(window.baseUrl).concat(s.media.ios_url);else{var u=0===s.media.type?a.PUBLIC_DOMAIN:a.MEDIA_DOMAIN_3D;s.media.url=(0,i.ZP)(s.media.url,u,l().ios()?2048:void 0)}}))}))},c=n(9669),f=n.n(c);function p(t,e,n,r,o,a,i){try{var s=t[a](i),l=s.value}catch(t){return void n(t)}s.done?e(l):Promise.resolve(l).then(r,o)}var d,m={},h=function(){var t,e=(t=regeneratorRuntime.mark((function t(e){var n,r,o,i,s,l;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.tid,r=e.json,m[n]){t.next=13;break}return o=window.baseUrl?window.baseUrl+"/":a.JSON_DOMAIN,t.next=5,f().get("".concat(o).concat(r));case 5:if(200===(i=t.sent).status){t.next=8;break}return t.abrupt("return",null);case 8:s=i.data,l=s.scenes[0],(c=l.extConfig).env||(c.env={type:0,colors:["26,26,26,1"],refImageUrl:"/object3d-assets/refImages/Light_source1_2k.jpg",light:{intensity:1}}),c.materials||(c.materials=[{name:"line",opacity:1,color:"#010101",doubleside:!0,emissive:"#000000",metalness:0,roughness:.5,transparent:!1,wireframe:!1,envMapIntensity:1},{name:"material",opacity:1,color:"#ff450d",doubleside:!0,emissive:"#000000",metalness:0,roughness:.651639,transparent:!1,wireframe:!1,envMapIntensity:1}]),c.rotation||(c.rotation={autoRotate:!0,speed:.1}),u(l.extConfig),m[n]=l;case 13:return t.abrupt("return",m[n]);case 14:case"end":return t.stop()}var c}),t)})),function(){var e=this,n=arguments;return new Promise((function(r,o){var a=t.apply(e,n);function i(t){p(a,r,o,i,s,"next",t)}function s(t){p(a,r,o,i,s,"throw",t)}i(void 0)}))});return function(t){return e.apply(this,arguments)}}(),y=n(98490),v=n(67310),g=n(68330),b=n.n(g),w=n(29905),x=n.n(w),k=n(49700);n(54244);function R(t){return R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},R(t)}function P(t,e,n,r,o,a,i){try{var s=t[a](i),l=s.value}catch(t){return void n(t)}s.done?e(l):Promise.resolve(l).then(r,o)}function _(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var a=t.apply(e,n);function i(t){P(a,r,o,i,s,"next",t)}function s(t){P(a,r,o,i,s,"throw",t)}i(void 0)}))}}function O(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function M(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function C(t,e){return C=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},C(t,e)}function E(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=j(t);if(e){var o=j(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return I(this,n)}}function I(t,e){if(e&&("object"===R(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return S(t)}function S(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function j(t){return j=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},j(t)}function B(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var D=(0,v.Z)({loading:["加载中...","Loading..."],noPass:["审核不通过，加载失败","Failed to load due to non-compliance"],play:["自动旋转","Auto Rotation"],pause:["暂停旋转","Pause Rotation"]})(d=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&C(t,e)}(l,t);var e,n,o,s=E(l);function l(){var t;O(this,l);for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return B(S(t=s.call.apply(s,[this].concat(n))),"state",{loading:!1,noPass:!1,autoRotate:!0}),B(S(t),"init",_(regeneratorRuntime.mark((function e(){var n,r,o,s,l,u,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.player.clear(),2!==(r=t.props.htmlData).status){e.next=5;break}return t.setState({noPass:!0,loading:!1}),e.abrupt("return");case 5:return t.setState({loading:!0,noPass:!1}),e.next=8,h(r);case 8:return o=e.sent,s=o.url,l=o.extConfig,e.next=12,t.player.load((0,i.ZP)(s,a.MEDIA_DOMAIN_3D),{extConfig:l});case 12:e.sent.animations.length>0&&!1!==(null==l||null===(n=l.animation)||void 0===n?void 0:n.autoPlay)&&(t.player.animation.setSpeed(null!==(u=null==l||null===(c=l.animation)||void 0===c?void 0:c.speed)&&void 0!==u?u:1),t.player.animation.play()),t.setState({loading:!1,scene:o,autoRotate:o.extConfig.rotation.autoRotate});case 15:case"end":return e.stop()}}),e)})))),B(S(t),"onClickRotation",(function(){if(t.state.autoRotate)t.player.setAutoRotation({enable:!1}),t.setState({autoRotate:!1});else{var e=t.state.scene.extConfig.rotation.speed;t.player.setAutoRotation({enable:!0,speed:e}),t.setState({autoRotate:!0})}})),B(S(t),"renderRotation",(function(){var e=t.state,n=e.autoRotate,o=e.loading,a=e.noPass;if(o||a)return null;var i=t.props.lang;return r.createElement(k.Z,{onClick:t.onClickRotation,vertical:"center",style:{position:"absolute",bottom:30,left:"50%",transform:"translateX(-50%)",color:"#fff",border:"2px solid rgba(250, 100, 0, 1)",borderRadius:40,height:40,padding:"0 15px",cursor:"pointer"}},r.createElement("img",{style:{width:24,height:24,marginRight:10},src:n?x():b(),alt:""}),r.createElement("div",null,n?i.pause:i.play))})),t}return e=l,(n=[{key:"componentDidMount",value:function(){this.player=new y.ZP({baseUrl:window.baseUrl?window.sdkUrl+"player/js":void 0}),this.player.init("#Object3dWp"),this.init()}},{key:"componentDidUpdate",value:function(t,e){if(this.props.htmlData!==t.htmlData&&this.init(),this.state.loading!==e.loading){var n=this.props.onChangeLoading;n&&n(this.state.loading)}}},{key:"render",value:function(){var t=this.props.lang,e=this.state,n=e.loading,o=e.noPass;return r.createElement("div",{style:{width:"100%",height:"100%"}},r.createElement("div",{style:{width:"100%",height:"100%"},id:"Object3dWp"}),n?r.createElement("div",{style:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)",color:"#fff"}},t.loading):null,o?r.createElement("div",{style:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)",color:"#fff"}},t.noPass):null,this.renderRotation())}}])&&M(e.prototype,n),o&&M(e,o),l}(r.PureComponent))||d,U=D,A=n(45751),T=n.n(A),N=n(15753),Z=n.n(N),L=n(47166),H=n.n(L),F={arrowLeft:"arrowLeft--W51bR",arrowRight:"arrowRight--F8Bx5",disable:"disable--CD_w3",listBox:"listBox--GNSel",ScrollbarsBox:"ScrollbarsBox--i01EM",listItem:"listItem--Znynk",listItemText:"listItemText--aXnfR",isMusic:"isMusic--qTrMG"},W=(n(57327),n(92317));function z(t,e,n,r,o,a,i){try{var s=t[a](i),l=s.value}catch(t){return void n(t)}s.done?e(l):Promise.resolve(l).then(r,o)}var G,X={},q=function(){var t,e=(t=regeneratorRuntime.mark((function t(e){var n,r,o,i,s,l,u,c;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(n=[],r=[],o=0;o<e.length;o++)i=e[o],X[i]?r.push(X[i]):(s=window.baseUrl?window.baseUrl:a.API_DOMAIN,n.push(W.Z.get("".concat(s,"/3dmodel/").concat(i,"/json"))));if(0===n.length){t.next=8;break}return t.next=6,Promise.all(n);case 6:for(l=t.sent,u=0;u<l.length;u++)1===(c=l[u]).success&&(X[c.data.tid]=c.data,r.push(c.data));case 8:return r=r.filter((function(t){return t.json})),t.abrupt("return",r);case 10:case"end":return t.stop()}}),t)})),function(){var e=this,n=arguments;return new Promise((function(r,o){var a=t.apply(e,n);function i(t){z(a,r,o,i,s,"next",t)}function s(t){z(a,r,o,i,s,"throw",t)}i(void 0)}))});return function(t){return e.apply(this,arguments)}}(),J=n(39768),K=n(23413);n(89968);function Q(t){return Q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Q(t)}function V(t,e,n,r,o,a,i){try{var s=t[a](i),l=s.value}catch(t){return void n(t)}s.done?e(l):Promise.resolve(l).then(r,o)}function Y(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var a=t.apply(e,n);function i(t){V(a,r,o,i,s,"next",t)}function s(t){V(a,r,o,i,s,"throw",t)}i(void 0)}))}}function $(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function tt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function et(t,e){return et=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},et(t,e)}function nt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=at(t);if(e){var o=at(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return rt(this,n)}}function rt(t,e){if(e&&("object"===Q(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return ot(t)}function ot(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function at(t){return at=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},at(t)}function it(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var st=H().bind(F),lt=(0,v.Z)({na:["内容已删除","NA"]})(G=(0,K.Z)({default:{maxHeight:"100%",column:3},1024:{maxHeight:"calc(100vh - 80px)",column:2}})(G=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&et(t,e)}(u,t);var e,n,s,l=nt(u);function u(){var t;$(this,u);for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return it(ot(t=l.call.apply(l,[this].concat(n))),"state",{isBack:!1,status:0,index:0,init:!1,data:[]}),it(ot(t),"init",Y(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,q(t.props.data.modelTids);case 2:n=e.sent,t.props.data.modelTids.length>1?t.setState({status:1,init:!0,data:n}):t.setState({status:2,init:!0,data:n});case 4:case"end":return e.stop()}}),e)})))),it(ot(t),"onClickListItem",(function(e){var n=t.props.data,r=n.displayStyle,o=(n.modelTids,t.state.data);1===r?window.dispatch({type:"modals/openMultiple",modalType:"Object3Iframe",data:o[e].tid}):t.setState({index:e,status:2,isBack:!0})})),it(ot(t),"renderList",(function(){var e=t.state.data,n=t.props.size,o=t.props.data.musicMediaUrl;return r.createElement(k.Z,{vertical:"center",className:"".concat(F.listBox," ").concat(o?F.isMusic:"")},r.createElement(J.Z,{style:{maxHeight:n.maxHeight,width:"100%"}},r.createElement(k.Z,{layout:"flow",className:F.ScrollbarsBox},e.map((function(e,n){var o=e.thumbUrl,s=e.name,l=(0,i.ZP)(o,a.THUMB_DOMAIN,600);return r.createElement(k.Z,{vertical:"center",horizontal:"center",onClick:t.onClickListItem.bind(ot(t),n),key:n,className:F.listItem,style:{backgroundImage:"url(".concat(l,")"),backgroundColor:"#383838"}},r.createElement("div",{className:F.listItemText},s))})))))})),it(ot(t),"loading",!0),it(ot(t),"onClickLeft",(function(){if(!t.loading){var e,n=t.state.data,r=t.state.index;e=0===r?n.length-1:r-1,t.setState({index:e})}})),it(ot(t),"onClickRight",(function(){if(!t.loading){var e=t.state.index+1;e>t.state.data.length-1&&(e=0),t.setState({index:e})}})),it(ot(t),"renderMain",(function(){var e=t.state,n=e.status,o=e.index;if(!e.init)return null;var a=t.state.data;return 0===a.length?r.createElement("div",{style:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)",color:"#fff"}},t.props.lang.na):0===n?null:1===n?t.renderList():2===n?r.createElement(r.Fragment,null,r.createElement("img",{onClick:t.onClickLeft,src:T(),className:st("arrowLeft",{disable:1===a.length}),alt:""}),r.createElement("img",{onClick:t.onClickRight,src:Z(),className:st("arrowRight",{disable:1===a.length}),alt:""}),r.createElement(U,{onChangeLoading:function(e){return t.loading=e},htmlData:a[o]})):void 0})),it(ot(t),"renderTitle",(function(){var e=t.state,n=e.status,r=e.index;if(0===n)return null;var o=t.props,a=o.data,i=(o.language,a.title),s=t.state.data.length;return 1===n?"".concat(i," (").concat(s,")"):s>1?"".concat(i," (").concat(r+1,"/").concat(s,")"):i})),it(ot(t),"onBack",(function(){t.setState({status:1,isBack:!1})})),t}return e=u,(n=[{key:"componentDidMount",value:function(){this.init()}},{key:"render",value:function(){var t=this.props,e=t.data,n=t.handleClose,a=this.state.isBack,i=this.props.animation.opacityAnimation;return r.createElement(o.Z,{style:i,isBack:a,onBack:this.onBack,title:this.renderTitle(),data:e,handleClose:n},this.renderMain())}}])&&tt(e.prototype,n),s&&tt(e,s),u}(r.PureComponent))||G)||G,ut=lt},29905:function(t,e,n){t.exports=n.p+"imgs/pauseIcon.26aa6eae.png"},68330:function(t,e,n){t.exports=n.p+"imgs/playIcon.1725a311.png"}}]);